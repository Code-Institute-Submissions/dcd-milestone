{% extends 'base.html' %} {%block title %}| Recipes{% endblock %} {% block content %}

<section>
    <div class="page_heading">Find the right recipe for you</div>

    <form method="POST" action="{{ url_for('search') }}">
        <div class="input-field" id="recipe-search">
            <input id="search" type="search" required name='search_term'>
            <label class="label-icon" for="search"><i class="fas fa-search" aria-hidden="true"></i></label>
            <i class="material-icons">close</i>
        </div>
    </form>

</section>

{% if current_category %}
<h3>{{current_category}}</h3> {% endif %}

<section class="category_filters">
    <div class="container">
        <div class="row">

            {% for category in categories %}
            <a href="{{url_for('view_category', category=category.name)}}" id="category-btn" class="waves-effect waves-light btn btn_small">{{category.name}}</a> {% endfor %}

        </div>
    </div>
</section>

<section id="card-display" class="container">
    <div class="row">

            {% for recipe in recipes %}
            <div class="col s12 m6 l3  search-recipe-card">
                <div class="card">
                    <div class="card-image">
                        <a class="waves-effect waves-light" href="{{url_for('view_recipe', slug=recipe.slug)}}">
          {% if recipe.image_url %}
			<img src="{{ recipe.image_url }}" class="responsive-img" alt="{{ recipe.name }}" height="400" width="375">
          {% else %}
            <img src="{{ url_for('static', filename='img/default-recipe-img.jpg') }}" alt="{{ recipe.name }}">
          {% endif %}     
		</a>

                        <a href="{{url_for('view_recipe', slug=recipe.slug)}}" class="card-label"> {{ recipe.category_name }}</a>
                    </div>
                    <div class="card-content">
                        <a class="waves-effect waves-light" href="{{url_for('view_recipe', slug=recipe.slug)}}">
                            <span class="black-text card-title">{{ recipe.name|title }}</span></a>
                        <p class="teal-text cooking-text">{{ recipe.cooking_time}}
                            <p>
                    </div>
                </div>
            </div>
            {% endfor %}
</section>

<td>

    <a href="{{url_for('view_recipe', slug=recipe.slug)}}" id="view-btn" class="waves-effect waves-light btn btn_small blue darken-1">View</a>

    <a href="{{url_for('edit_recipe', recipe_id=recipe._id)}}" id="edit-btn" class="waves-effect waves-light btn btn_small light-blue darken-1">Edit</a>
    <!-- Modal Trigger -->
    <button data-target="delete_modal" data-recipe-delete-url="{{url_for('delete_recipe', recipe_id=recipe._id)}}" a class="waves-effect waves-light btn btn_small red darken-1 modal-trigger" href="#delete_modal">Delete</a>
    </button>

</td>
</tr>
{% endfor %}

</tbody>
</table>

<div id="delete_modal" class="modal">
    <div class="modal-content">
        <h6>Are you sure you want to delete this recipe?</h6>
    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect waves-red btn-flat">Cancel</a>
        <a id="delete-link" href="" class="modal-close waves-effect waves-green btn-flat modal-close">Delete</a>
    </div>
</div>

                 <a href="{{url_for('create_recipe')}}" id="view-btn" class="waves-effect waves-light btn btn_small blue darken-1">Add a New Recipe</a>

{% endblock %} {% block js %}
<script>
    $(document).ready(function() {
        $('.modal').modal({
            onOpenStart: function(modal, trigger) {
                $('#delete-link').attr("href", trigger.dataset.recipeDeleteUrl);
            }
        });
    });
</script>
{% endblock %}